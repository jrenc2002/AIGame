# 🔒 狼人杀身份隐藏功能实现

## 功能需求

用户希望：
- **默认隐藏身份** - 其他玩家的身份不显示
- **显示自己的身份** - 只能看到自己的角色信息
- **保持游戏公平性** - 符合狼人杀游戏规则

## 实现方案

### 1. 身份显示逻辑修改 🎭

#### **PlayerCard组件身份显示规则**
```typescript
showRole={
  (player.id === currentPlayer?.id) || // 显示自己的身份
  (showRoles) || // 管理员模式显示所有身份
  (gameState.currentPhase === 'game_over') // 游戏结束显示所有身份
}
```

**显示规则**：
- ✅ **自己的身份**：始终显示
- ❌ **其他玩家身份**：默认隐藏
- 🔧 **上帝视角模式**：管理员可开启查看所有身份
- 🏁 **游戏结束**：显示所有玩家身份

### 2. 角色信息面板 📋

#### **新增RoleDisplay组件**
```typescript
<RoleDisplay player={currentPlayer} />
```

**功能特点**：
- 🎯 **专门显示玩家自己的身份信息**
- 📖 **详细的角色描述和技能说明**
- 🏆 **明确的胜利条件提示**
- 🎨 **美观的渐变背景设计**

#### **RoleDisplay组件结构**
```typescript
- 角色图标 (大图标展示)
- 角色名称 (如：预言家、狼人等)
- 角色描述 (功能说明)
- 技能列表 (具体能力)
- 胜利条件 (获胜方式)
```

### 3. UI交互优化 🎮

#### **按钮文本更新**
```typescript
// 原来: "显示身份" / "隐藏身份"
// 现在: "开启上帝视角" / "关闭上帝视角"
```

**好处**：
- 更清楚地表明这是管理员功能
- 避免玩家误以为这是正常游戏功能

#### **提示信息优化**
```typescript
// 游戏开始时
toast.success(`你的身份是：${ROLE_CONFIGS[playersWithRoles[0].role].name}`)
toast.info('其他玩家的身份已隐藏，只能看到自己的身份')

// 游戏重启时
toast.info('游戏重新开始，身份重新分配')
```

### 4. 游戏阶段处理 🎪

#### **不同阶段的身份显示**

| 游戏阶段 | 自己身份 | 其他身份 | 说明 |
|---------|---------|---------|------|
| 🎬 **准备阶段** | ✅ 显示 | ❌ 隐藏 | 查看自己角色，准备策略 |
| 🌙 **夜晚阶段** | ✅ 显示 | ❌ 隐藏 | 根据身份执行夜晚技能 |
| ☀️ **讨论阶段** | ✅ 显示 | ❌ 隐藏 | 隐藏身份进行推理 |
| 🗳️ **投票阶段** | ✅ 显示 | ❌ 隐藏 | 基于推理进行投票 |
| 🏁 **游戏结束** | ✅ 显示 | ✅ 显示 | 揭示所有身份，复盘游戏 |

### 5. 代码修改总结 📝

#### **修改的文件**
1. `src/view/WerewolfGameView.tsx` - 主要游戏视图
2. `src/components/werewolf/RoleDisplay.tsx` - 新增角色展示组件

#### **关键修改点**
```typescript
// 1. PlayerCard身份显示逻辑
showRole={
  (player.id === currentPlayer?.id) || 
  (showRoles) || 
  (gameState.currentPhase === 'game_over')
}

// 2. 按钮文本更新
{showRoles ? '关闭上帝视角' : '开启上帝视角'}

// 3. 游戏初始化不再默认显示所有身份
// setShowRoles(true) // 删除这行

// 4. 添加角色信息面板
<RoleDisplay player={currentPlayer} />
```

## 用户体验提升 🌟

### ✅ **改进前后对比**

| 功能 | 改进前 | 改进后 |
|------|--------|--------|
| **身份显示** | 所有玩家身份可见 | 只显示自己身份 |
| **游戏公平性** | 不符合狼人杀规则 | 符合标准规则 |
| **角色信息** | 简单显示 | 详细的技能和胜利条件 |
| **管理员模式** | 混淆概念 | 清楚的"上帝视角"标识 |

### 🎯 **核心优势**

1. **游戏真实性** - 符合传统狼人杀规则
2. **策略性增强** - 玩家需要通过发言和行为推断身份
3. **沉浸感提升** - 真正的狼人杀体验
4. **信息清晰** - 自己的角色信息一目了然

## 测试验证 🧪

启动游戏后验证：
1. ✅ 只能看到自己的身份卡片显示角色
2. ✅ 其他玩家显示为"?"或隐藏状态
3. ✅ 左侧面板显示详细的角色信息
4. ✅ "上帝视角"按钮可以切换显示所有身份
5. ✅ 游戏结束时自动显示所有身份

完美实现了狼人杀游戏的身份隐藏机制！🎉 